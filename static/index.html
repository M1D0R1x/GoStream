<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GoStream</title>
    <style>
        body {
            font-family: sans-serif;
            background: #f0f0f0;
            padding: 2rem;
        }
        video {
            width: 100%;
            max-width: 720px;
            margin-bottom: 1rem;
            display: block;
        }
        .video-list button {
            display: block;
            padding: 0.5rem 1rem;
            margin: 0.3rem 0;
            cursor: pointer;
        }
        .error {
            color: red;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
<h1>ðŸŽ¥ GoStream</h1>
<video id="player" controls></video>
<div class="error" id="error"></div>
<div class="video-list" id="videoList"></div>

<script>
    const player = document.getElementById('player');
    const videoList = document.getElementById('videoList');
    const errorDiv = document.getElementById('error');

    // Fetch video list
    fetch('/videos')
        .then(res => {
            if (!res.ok) {
                throw new Error(`Failed to fetch videos: ${res.status} ${res.statusText}`);
            }
            return res.json();
        })
        .then(data => {
            if (data.length === 0) {
                errorDiv.textContent = 'No videos found.';
                return;
            }
            data.forEach(video => {
                const btn = document.createElement('button');
                btn.textContent = video.name;
                btn.onclick = () => {
                    errorDiv.textContent = ''; // Clear previous errors
                    player.src = video.url;
                    player.play().catch(err => {
                        errorDiv.textContent = `Error playing video: ${err.message}`;
                        console.error('Playback error:', err);
                    });
                };
                videoList.appendChild(btn);
            });
        })
        .catch(err => {
            errorDiv.textContent = `Error loading video list: ${err.message}`;
            console.error('Fetch error:', err);
        });

    // Log video errors (e.g., if the video file is not found or invalid)
    player.addEventListener('error', () => {
        errorDiv.textContent = `Video error: ${player.error ? player.error.message : 'Unknown error'}`;
    });
</script>
</body>
</html>